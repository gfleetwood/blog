<!DOCTYPE html>
<html lang="en-US">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="description" content="Simple minimalist theme">
<meta name="keywords" content="minimalist,blog,goa,hugo,developer">

<base href="/">

<title>technologiad</title>

<meta name="generator" content="Hugo 0.54.0" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">


<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400|Roboto+Slab:400,700|Roboto:300,300i,400,400i,500,500i,700,700i">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css">
<link rel="stylesheet" href="/css/main.css">




<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

</head>
<body lang="en-US">
<div class="container">


<header class="row text-left title">
  <h1 class="title">Income &amp; New York&#39;s Subway</h1>
</header>
<section id="category-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-left meta">
        PUBLISHED ON MAR 25, 2019 
      
      
      
      —
      
      
      <a class="meta" href="/categories/data-viz">DATA-VIZ</a>
      
      
      
    </h6>
  </div>
  
</section>
<section id="content-pane" class="row">
  <div class="col-md-12 text-justify content">
    
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="/rmarkdown-libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/bootstrap/js/bootstrap.min.js"></script>
<link href="/rmarkdown-libs/selectize/css/selectize.bootstrap3.css" rel="stylesheet" />
<script src="/rmarkdown-libs/selectize/js/selectize.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/leaflet/leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet/leaflet.js"></script>
<link href="/rmarkdown-libs/leafletfix/leafletfix.css" rel="stylesheet" />
<script src="/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js"></script>
<script src="/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js"></script>
<link href="/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-binding/leaflet.js"></script>
<link href="/rmarkdown-libs/leaflet-easybutton/easy-button.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-easybutton/easy-button.js"></script>
<script src="/rmarkdown-libs/leaflet-easybutton/EasyButton-binding.js"></script>
<link href="/rmarkdown-libs/leaflet-locationfilter2/locationfilter.css" rel="stylesheet" />
<script src="/rmarkdown-libs/leaflet-locationfilter2/locationfilter.js"></script>
<script src="/rmarkdown-libs/leaflet-locationfilter2/locationfilter-bindings.js"></script>
<link href="/rmarkdown-libs/ionicons/ionicons.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>My favorite data visualization is <a href="https://projects.newyorker.com/story/subway/">Inequality And New York’s Subway</a>. It provides a fascinating look into the city via its main circulatory system. The information is a bit dated now (the data is from 2011), and I’ve always wanted to update it. However, navigating the US Census Bureau’s data portal always ended with me closing the tab in frustration.</p>
<p>My luck changed when Safe Graph released <a href="https://www.safegraph.com/open-census-data">free neighborhood census data from 2016</a>. Even so it took a while for me to sit down and get stuck into the process. It was certainly more work than I anticipated, and the final product isn’t an exact replica, but I completed the New York City’s Subway And Income interactive visualization which is available to play around with at the bottom of this post. Here’s the tale of my journey.</p>
</div>
<div id="methodology" class="section level2">
<h2>Methodology</h2>
<p>Safe Graph’s data is broken down into census blocks across the United States with associated data - including median income. New York City’s share of the data at the income level had 9% of records missing which wasn’t egregious enough to be worrying. The first toil was to match subway stations to census blocks.</p>
<pre class="r"><code>library(tidyverse)
library(leaflet)
library(geosphere) # Haversine distance
library(crosstalk)
library(plotly)
library(formattable) # Format currencies

calc_dist &lt;- function(lon1, lat1, lon2, lat2){
    
    dist &lt;- distm(c(lon1, lat1), c(lon2, lat2), fun = distHaversine)
    return(dist)
    
}

# Gets all the stops for a given train
get_train_stops &lt;- function(train, stops){
    
    result &lt;- stops %&gt;% 
        ungroup() %&gt;% 
        mutate(has_train = map(trains_list, function(x) train %in% x)) %&gt;% 
        filter(has_train == TRUE) %&gt;% 
        select(-has_train, -trains, -trains_list) %&gt;% 
        mutate(train = train)
    
    return(result)
    
}

# Ultimately unused but not discarded due to strange sentimental reasons
sort_stations &lt;- function(df){
    
    if(nrow(df) == 1) return(df)
    
    start &lt;- df[1,]
    
    df &lt;- df[2:nrow(df), ] %&gt;%
        mutate(dist = unlist(pmap(list(longitude, latitude, start$longitude, start$latitude),
                              function(x, y, z1, z2) calc_dist(x, y, z1, z2)))) %&gt;% 
        arrange(dist) %&gt;% select(-dist)
    
    return(rbind(start, sort_stations(df)))
    
}</code></pre>
<pre class="r"><code>nyc_counties &lt;- c(&quot;Queens County&quot;, &quot;Bronx County&quot;, &quot;Kings County&quot;, &quot;New York County&quot;)
df &lt;- read_csv(&quot;~/data/safegraph_open_census_data/metadata/cbg_geographic_data.csv&quot;)

nyc_cbg &lt;- read_csv(&quot;~/data/safegraph_open_census_data/metadata/cbg_fips_codes.csv&quot;) %&gt;%
    filter(state == &quot;NY&quot;, county %in% nyc_counties) %&gt;% 
    # Creating the first five numbers of the cbg id 
    mutate(cbg_first_five = paste(state_fips, county_fips, sep = &quot;&quot;)) %&gt;% 
    pull(cbg_first_five)

nyc_census_blocks &lt;- read_csv(&quot;~/data/safegraph_open_census_data/data/cbg_b19.csv&quot;) %&gt;% 
    select(census_block_group, B19049e1) %&gt;% 
    rename(median_household_income = B19049e1) %&gt;% 
    inner_join(df %&gt;% select(census_block_group, latitude, longitude)) %&gt;% 
    mutate(cbg_first_5 = str_sub(as.character(census_block_group), 1, 5)) %&gt;% 
    filter(cbg_first_5 %in% nyc_cbg) %&gt;% 
    # The id column is just an aid to do the cartesian product of stations &amp; census groups
    # I later discovered a much easier method with tidyr::crossing but didn&#39;t bother to change the code
    mutate(id = 1)</code></pre>
<p>I downloaded that data from the <a href="https://data.cityofnewyork.us/Transportation/Subway-Stations/arq3-7z49">NYC Open Data portal</a>, and, in the first of two inelegant choices, took the cartesian product of the stations and the blocks. The other moment of inelegance soon followed as I calculated the <a href="https://en.wikipedia.org/wiki/Haversine_formula">Haversine Distance</a> between every station and block.</p>
<pre class="r"><code>stations_cleaned &lt;- read_csv(&quot;~/data/DOITT_SUBWAY_STATION_01_13SEPT2010.csv&quot;) %&gt;% 
    # Cleaning the location data
    mutate(the_geom = str_sub(the_geom, 8)) %&gt;% 
    mutate(the_geom = str_replace(the_geom, &quot;\\)&quot;, &quot;&quot;)) %&gt;% 
    separate(the_geom, c(&quot;longitude_&quot;, &quot;latitude_&quot;), sep = &quot; &quot;) %&gt;% 
    mutate(longitude_ = as.numeric(longitude_), latitude_ = as.numeric(latitude_)) %&gt;% 
    select(NAME, longitude_, latitude_, LINE) %&gt;% 
    # See the explanation given above in the creation of nyc_census_blocks for the id column
    # The station_id uniquely identifies stations since some have the same name
    mutate(id = 1, station_id = row.names(.))

# There&#39;s probably a better way to do this than finding the cross product and generating all the distances.

train_stations_census_blocks &lt;- stations_cleaned %&gt;% 
    inner_join(nyc_census_blocks) %&gt;%
    mutate(dist = unlist(pmap(list(longitude_, latitude_, longitude, latitude),
                              function(x, y, z1, z2) calc_dist(x, y, z1, z2))))

write_csv(train_stations_census_blocks, &quot;nyc_train_stations_income_cbg.csv&quot;)</code></pre>
<p>Next came the decision of what should be considered close. One mile seemed like a good threshold, so I discarded census blocks more than that distance away from a given station. Each stop being linked to several blocks prompted the question of how to collate income level. I decided to continue using the median. Thus, each station’s income became the median of the median income of the census blocks within one mile.</p>
<pre class="r"><code>mta_income &lt;- read_csv(&quot;~/data/subway_income/nyc_train_stations_income_cbg.csv&quot;)

station_locations &lt;- mta_income %&gt;% 
    select(station_id, longitude_, latitude_) %&gt;% 
    group_by(station_id) %&gt;% 
    summarise(longitude = longitude_[1], latitude = latitude_[1]) %&gt;% 
    ungroup()

income_1_mile &lt;- mta_income %&gt;%
    # 1 mile is 1069 meters
    filter(dist &lt;= 1069) %&gt;% 
    group_by(station_id, NAME) %&gt;%
    summarise(median_income = round(median(median_household_income, na.rm = T)),
              trains = LINE[1]) %&gt;% 
    mutate(trains_list = str_split(trains, &quot;-&quot;)) %&gt;% 
    ungroup()</code></pre>
<p>More matching followed as I needed to associate stops with train lines. That produced a data set of train-station combinations along with their median income.</p>
<pre class="r"><code>trains &lt;- str_split(income_1_mile$trains, &quot;-&quot;) %&gt;% 
    unlist() %&gt;% 
    unique() %&gt;% 
    purrr::discard(~ str_detect(., &quot;Express&quot;))

train_stops &lt;- map_df(trains, ~ get_train_stops(., income_1_mile)) 
write_csv(train_stops, &quot;~/data/subway_income/nyc_train_stops_income.csv&quot;)</code></pre>
<p>At this point I felt that I was almost home free. The imaginary celebratory bottle of champagne was almost out when I remembered that I had to deal with boroughs and stations being in the correct order. Past experience made me hesitant to try scraping, so the dreaded thought of manual data entry entered my head for the first time.</p>
<p>That had to be a last resort with 847 stations to go through. I considered viewing ordering stations as a graph theory problem, i.e find the shortest path between the complete graph of a train’s stations. Research told me this was a Hamilton path - a term half-remembered from a nostalgic Discrete Math course in my undergrad days. It also happened to be an NP hard problem. Not that then. On the boroughs issue reverse geo-encoding also proved to be a dead end.</p>
<p>After some more ruminating, I bit the bullet and started the hand-labeling. With one train line down I hit upon another idea for ordering the stations:</p>
<ol style="list-style-type: decimal">
<li><p>Label the first station for each train and set it as the origin</p></li>
<li><p>Find the Haversine distance between the target and the other stations</p></li>
<li><p>The closest of these is the next station</p></li>
<li><p>Set this station as the new target and repeat steps 2 and 3 all the stations are in order.</p></li>
</ol>
<p>Fully labeling one train line gave me a immediate testing space for this solution and it worked perfectly. Unfortunately, Trying it on another train line didn’t go that well. Even with this method I would have to do Q.A on the entire data set and still need to fill in the boroughs. It seemed that getting my hands dirty was the only good option.</p>
</div>
<div id="the-final-product" class="section level2">
<h2>The Final Product</h2>
<p>About two weeks later it was finally time for the pay-off. The duo of leaflet and plotly came into the spotlight to provide the centerpiece. With that a long standing item disappeared from my To Do list. Solving Moravec’s Paradox is up next.</p>
<pre class="r"><code>train_stops &lt;- read_csv(&quot;~/data/subway_income/nyc_train_stops_income_order_borough2.csv&quot;) %&gt;%
    mutate(train = as.factor(train))

df &lt;- SharedData$new(train_stops)

ax &lt;- list(title = &quot;&quot;, zeroline = FALSE, showline = FALSE, showticklabels = FALSE, showgrid = FALSE)

bscols(widths = c(3, NA, NA),
       filter_select(&quot;train&quot;, &quot;Train&quot;, df, ~train, multiple = F),
       leaflet(data = df, width = &quot;100%&quot;) %&gt;% addTiles() %&gt;% 
           #addMarkers(~longitude, ~latitude, label = ~as.character(NAME)),
           addPolylines(~longitude, ~latitude, weight = 3, opacity = 5),
        plot_ly(df, 
                x = ~station_order, 
                y = ~median_income, 
                type = &#39;scatter&#39;, 
                mode = &#39;lines+markers&#39;,
                hoverinfo = &#39;text&#39;,
                marker = list(color = &#39;rgb(255, 0, 0, .1&#39;, size = 5),
                text = ~paste(NAME, &#39;(&#39;, borough, &#39;)&#39;, &#39;&lt;/br&gt;&lt;/br&gt;&#39;, currency(median_income))) %&gt;%
           layout(title = &quot;NYC Subway And Income&quot;, xaxis = ax, yaxis = list(title = &#39;Median Income&#39;))
       )</code></pre>
<div class="container-fluid crosstalk-bscols">
<div class="fluid-row">
<div class="col-xs-3">
<div id="train" class="form-group crosstalk-input-select crosstalk-input">
<label class="control-label" for="train">Train</label>
<div>
<select></select>
<script type="application/json" data-for="train">{
  "items": {
    "value": ["1", "2", "3", "4", "5", "6", "7", "A", "B", "C", "D", "E", "F", "G", "J", "L", "M", "N", "Q", "R", "S", "W", "Z"],
    "label": ["1", "2", "3", "4", "5", "6", "7", "A", "B", "C", "D", "E", "F", "G", "J", "L", "M", "N", "Q", "R", "S", "W", "Z"]
  },
  "map": {
    "1": ["19", "20", "21", "22"],
    "2": ["23", "24", "25", "26", "27", "28", "29", "30"],
    "3": ["31", "32", "33"],
    "4": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11"],
    "5": ["85", "86", "87", "88", "89", "90", "91", "92"],
    "6": ["12", "13", "14", "15", "16", "17", "18"],
    "7": ["93", "94", "95", "96", "97", "98"],
    "A": ["34", "35", "36", "37", "38", "39"],
    "B": ["40", "41"],
    "C": ["42", "43", "44"],
    "D": ["69", "70", "71", "72", "73"],
    "E": ["45", "46", "47", "48", "49", "50"],
    "F": ["99", "100", "101", "102"],
    "G": ["103", "104", "105", "106"],
    "J": ["65", "66", "67"],
    "L": ["107", "108", "109", "110"],
    "M": ["51", "52", "53", "54", "55", "56"],
    "N": ["74", "75", "76", "77", "78", "79"],
    "Q": ["80", "81", "82", "83"],
    "R": ["57", "58", "59", "60", "61", "62", "63", "64"],
    "S": ["84"],
    "W": ["111", "112", "113", "114", "115", "116", "117"],
    "Z": ["68"]
  },
  "group": ["SharedData0932f068"]
}</script>
</div>
</div>
</div>
<div class="col-xs-4">
<div id="htmlwidget-1" style="width:100%;height:400px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addSelect","args":["SharedData0932f068"]},{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-74.0041310005885,-73.9767132992584,-73.9510700015425,-73.9580997367769,-73.9273847542618,-73.9679670004732,-73.9709563319228,-73.9076840015997,-73.9146849986034,-73.9504262489579,-73.9416169983714,-74.0041310005885,-73.8470359987544,-73.9767132992584,-73.9510700015425,-73.9679670004732,-73.8862829985325,-73.9416169983714,-74.0062770001748,-73.9956570016487,-73.9668470005456,-73.9335959996056,-73.8543153107622,-73.9580997367769,-74.0062770001748,-73.9956570016487,-73.9709563319228,-73.9077019387083,-73.8625097078866,-73.8506199987954,-73.9580997367769,-73.9709563319228,-73.9504262489579,-73.976336575218,-73.8438529979573,-73.7885219980118,-73.7969239998421,-73.8903580002471,-74.0052290023424,-73.976336575218,-73.8935090000331,-73.976336575218,-73.8903580002471,-74.0052290023424,-73.8987883783301,-73.8820347465864,-73.8303702709878,-73.9752485052734,-73.9205264716827,-74.0052290023424,-73.8987883783301,-73.8820347465864,-73.9752485052734,-73.9205264716827,-73.9356230012996,-73.8958980017196,-73.8987883783301,-73.8820347465864,-73.9879368338264,-73.9205264716827,-74.0255099996266,-74.0283979999864,-74.0018260000577,-74.0130072374272,-73.9166388842194,-73.8851940021643,-73.9356230012996,-73.9356230012996,-73.8935090000331,-73.9946587805514,-73.9936762000529,-73.9942022375285,-73.9812359981396,-73.929861999118,-73.9401635351909,-73.9879368338264,-73.9120340001031,-73.9214790001739,-73.9812359981396,-73.9879368338264,-73.9592431052215,-73.9812359981396,-73.9470660219183,-73.8438529979573,-74.0041310005885,-73.9767132992584,-73.8543153107622,-73.9580997367769,-73.9679670004732,-73.9077019387083,-73.8625097078866,-73.8308340021742,-73.8456249984179,-73.9489160009391,-73.9401635351909,-73.8964029993185,-73.8912051289911,-73.9240159984882,-73.8303702709878,-73.9723553085244,-73.9752569782215,-73.9812359981396,-73.9667959986695,-73.9514239994525,-73.9495999997552,-73.9502340010257,-73.9019160004208,-73.9030969995401,-73.9109757182647,-73.9229130000312,-73.929861999118,-73.9401635351909,-73.9879368338264,-73.9120340001031,-73.9214790001739,-74.0018260000577,-74.0130072374272],"lat":[40.7130649994331,40.7518074298163,40.7856719999861,40.6707651534489,40.8183034437232,40.7625260003046,40.6752946951032,40.8534530015569,40.8444340009268,40.6699381509305,40.7986290002001,40.7130649994331,40.8364880006082,40.7518074298163,40.7856719999861,40.7625260003046,40.826525000559,40.7986290002001,40.7228539977878,40.7440809998975,40.8039669996149,40.8495049997407,40.8982865155753,40.6707651534489,40.7228539977878,40.7440809998975,40.6752946951032,40.816437466864,40.8838879746253,40.9031250005412,40.6707651534489,40.6752946951032,40.6699381509305,40.7755193972926,40.6804289995884,40.5923740012124,40.5909270007813,40.672709999061,40.7208240000712,40.7755193972926,40.8669779999994,40.7755193972926,40.672709999061,40.7208240000712,40.7497195293568,40.7423700797217,40.714034819571,40.7600868323133,40.7569873591258,40.7208240000712,40.7497195293568,40.7423700797217,40.7600868323133,40.7569873591258,40.6971950005145,40.7062259982305,40.7497195293568,40.7423700797217,40.7496445600944,40.7569873591258,40.6297416668869,40.6226866671503,40.719465001059,40.7031423735991,40.6864152707044,40.6797779989612,40.6971950005145,40.6971950005145,40.8669779999994,40.6362608909614,40.6019504615723,40.6409127114447,40.5772810000675,40.7564420005104,40.7506356510148,40.7496445600944,40.7750356665237,40.766778666733,40.5772810000675,40.7496445600944,40.6173977444437,40.5772810000675,40.7842366501777,40.6804289995884,40.7130649994331,40.7518074298163,40.8982865155753,40.6707651534489,40.7625260003046,40.816437466864,40.8838879746253,40.8882999990101,40.7546219988126,40.7422159998632,40.7506356510148,40.7463249994103,40.7468675738291,40.7437810014913,40.714034819571,40.6032584051283,40.6207316231679,40.5772810000675,40.6880940010606,40.7127740007343,40.7441286664954,40.7003766662215,40.669145000614,40.6753446664081,40.6994710624271,40.7066066659887,40.7564420005104,40.7506356510148,40.7496445600944,40.7750356665237,40.766778666733,40.719465001059,40.7031423735991]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":3,"opacity":5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[40.5772810000675,40.9031250005412],"lng":[-74.0283979999864,-73.7885219980118]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="col-xs-4">
<div id="htmlwidget-2" style="width:100%;height:400px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"4b7b589a6899":["function () ","plotlyVisDat"]},"cur_data":"4b7b589a6899","attrs":{"4b7b589a6899":{"x":{},"y":{},"mode":"lines+markers","hoverinfo":"text","marker":{"color":"rgb(255, 0, 0, .1","size":5},"text":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"NYC Subway And Income","xaxis":{"domain":[0,1],"automargin":true,"title":"","zeroline":false,"showline":false,"showticklabels":false,"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Median Income"},"dragmode":"zoom","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":[21,30,36,11,42,32,13,48,46,10,39,1,34,10,15,12,28,19,6,11,23,30,60,8,22,27,10,44,57,61,11,13,10,49,15,5,6,24,40,18,36,28,3,19,19,21,28,11,16,2,29,31,21,26,8,2,39,41,27,36,3,2,21,17,14,19,11,8,39,11,4,12,1,41,39,33,45,43,1,27,9,1,34,null,15,17,40,8,18,24,37,45,21,6,8,14,15,10,40,6,9,1,11,17,20,15,20,19,14,12,19,17,11,23,21,5,1],"y":[81823,115391,105408,58752,28090,144167,96992,26196,25222,51250,33112,81823,45227,115391,105408,144167,27910,33112,109867,121738,78869,43101,53215,58752,109867,121738,96992,27560,40917,55178,58752,96992,51250,125488,59545,52375,51036,36794,104821,125488,31821,125488,36794,104821,51393,47441,70528,137824,63113,104821,51393,47441,137824,63113,47873,60345,51393,47441,106634,63113,60545,64770,81823,145658,41888,42727,47873,47873,31821,33828,45602,36645,44395,57462,54636,106634,62721,66449,44395,106634,54457,44395,103942,null,81823,115391,53215,58752,144167,27560,40917,69308,50408,104167,54636,53666,52232,56700,70528,50139,50341,44395,81290,72271,106641,32073,23836,31710,46250,50500,57462,54636,106634,62721,66449,81823,145658],"mode":"lines+markers","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text",null,"text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"rgb(255, 0, 0, .1","size":5,"line":{"color":"rgba(31,119,180,1)"}},"text":["Brooklyn Bridge - City Hall ( MAN ) <\/br><\/br> $81,823.00","Grand Central - 42nd St ( MAN ) <\/br><\/br> $115,391.00","96th St ( MAN ) <\/br><\/br> $105,408.00","Franklin Ave ( BRK ) <\/br><\/br> $58,752.00","149th St - Grand Concourse ( BRX ) <\/br><\/br> $28,090.00","Lexington Ave - 59th St ( MAN ) <\/br><\/br> $144,167.00","Grand Army Plaza ( BRK ) <\/br><\/br> $96,992.00","Burnside Ave ( BRX ) <\/br><\/br> $26,196.00","Mt Eden Ave ( BRX ) <\/br><\/br> $25,222.00","Nostrand Ave ( BRK ) <\/br><\/br> $51,250.00","116th St ( MAN ) <\/br><\/br> $33,112.00","Brooklyn Bridge - City Hall ( MAN ) <\/br><\/br> $81,823.00","Zerega Ave ( BRX ) <\/br><\/br> $45,227.00","Grand Central - 42nd St ( MAN ) <\/br><\/br> $115,391.00","96th St ( MAN ) <\/br><\/br> $105,408.00","Lexington Ave - 59th St ( MAN ) <\/br><\/br> $144,167.00","Whitlock Ave ( BRX ) <\/br><\/br> $27,910.00","116th St ( MAN ) <\/br><\/br> $33,112.00","Canal St ( MAN ) <\/br><\/br> $109,867.00","23rd St ( MAN ) <\/br><\/br> $121,738.00","Cathedral Pkwy (110th St) ( MAN ) <\/br><\/br> $78,869.00","181st St ( MAN ) <\/br><\/br> $43,101.00","Nereid Ave (238 St) ( BRX ) <\/br><\/br> $53,215.00","Franklin Ave ( BRK ) <\/br><\/br> $58,752.00","Canal St ( MAN ) <\/br><\/br> $109,867.00","23rd St ( MAN ) <\/br><\/br> $121,738.00","Grand Army Plaza ( BRK ) <\/br><\/br> $96,992.00","Jackson Ave ( BRX ) <\/br><\/br> $27,560.00","219th St ( BRX ) <\/br><\/br> $40,917.00","Wakefield - 241st St ( BRX ) <\/br><\/br> $55,178.00","Franklin Ave ( BRK ) <\/br><\/br> $58,752.00","Grand Army Plaza ( BRK ) <\/br><\/br> $96,992.00","Nostrand Ave ( BRK ) <\/br><\/br> $51,250.00","72nd St ( MAN ) <\/br><\/br> $125,488.00","Rockaway Blvd ( QNS ) <\/br><\/br> $59,545.00","Beach 60th St ( QNS ) <\/br><\/br> $52,375.00","Beach 67th St ( QNS ) <\/br><\/br> $51,036.00","Van Siclen Ave ( BRK ) <\/br><\/br> $36,794.00","Canal St - Holland Tunnel ( MAN ) <\/br><\/br> $104,821.00","72nd St ( MAN ) <\/br><\/br> $125,488.00","Kingsbridge Rd ( BRX ) <\/br><\/br> $31,821.00","72nd St ( MAN ) <\/br><\/br> $125,488.00","Van Siclen Ave ( BRK ) <\/br><\/br> $36,794.00","Canal St - Holland Tunnel ( MAN ) <\/br><\/br> $104,821.00","65th St ( QNS ) <\/br><\/br> $51,393.00","Elmhurst Ave ( QNS ) <\/br><\/br> $47,441.00","Kew Gardens - Union Tpke ( QNS ) <\/br><\/br> $70,528.00","5th Ave - 53rd St ( MAN ) <\/br><\/br> $137,824.00","Steinway St ( QNS ) <\/br><\/br> $63,113.00","Canal St - Holland Tunnel ( MAN ) <\/br><\/br> $104,821.00","65th St ( QNS ) <\/br><\/br> $51,393.00","Elmhurst Ave ( QNS ) <\/br><\/br> $47,441.00","5th Ave - 53rd St ( MAN ) <\/br><\/br> $137,824.00","Steinway St ( QNS ) <\/br><\/br> $63,113.00","Myrtle Ave ( BRK ) <\/br><\/br> $47,873.00","Fresh Pond Rd ( QNS ) <\/br><\/br> $60,345.00","65th St ( QNS ) <\/br><\/br> $51,393.00","Elmhurst Ave ( QNS ) <\/br><\/br> $47,441.00","Herald Sq - 34th St ( MAN ) <\/br><\/br> $106,634.00","Steinway St ( QNS ) <\/br><\/br> $63,113.00","77th St ( BRK ) <\/br><\/br> $60,545.00","86th St ( BRK ) <\/br><\/br> $64,770.00","Canal St ( MAN ) <\/br><\/br> $81,823.00","Whitehall St ( MAN ) <\/br><\/br> $145,658.00","Halsey St ( BRK ) <\/br><\/br> $41,888.00","Cleveland St ( BRK ) <\/br><\/br> $42,727.00","Myrtle Ave ( BRK ) <\/br><\/br> $47,873.00","Myrtle Ave ( BRK ) <\/br><\/br> $47,873.00","Kingsbridge Rd ( BRX ) <\/br><\/br> $31,821.00","50th St ( BRK ) <\/br><\/br> $33,828.00","Bay Pky ( BRK ) <\/br><\/br> $45,602.00","Ft Hamilton Pkwy ( BRK ) <\/br><\/br> $36,645.00","Coney Island - Stillwell Av ( BRK ) <\/br><\/br> $44,395.00","36th Ave ( QNS ) <\/br><\/br> $57,462.00","Queensboro Plz ( QNS ) <\/br><\/br> $54,636.00","Herald Sq - 34th St ( MAN ) <\/br><\/br> $106,634.00","Astoria - Ditmars Blvd ( QNS ) <\/br><\/br> $62,721.00","30th Ave ( QNS ) <\/br><\/br> $66,449.00","Coney Island - Stillwell Av ( BRK ) <\/br><\/br> $44,395.00","Herald Sq - 34th St ( MAN ) <\/br><\/br> $106,634.00","Ave M ( BRK ) <\/br><\/br> $54,457.00","Coney Island - Stillwell Av ( BRK ) <\/br><\/br> $44,395.00","96th St ( MAN ) <\/br><\/br> $103,942.00",null,"Brooklyn Bridge - City Hall ( MAN ) <\/br><\/br> $81,823.00","Grand Central - 42nd St ( MAN ) <\/br><\/br> $115,391.00","Nereid Ave (238 St) ( BRX ) <\/br><\/br> $53,215.00","Franklin Ave ( BRK ) <\/br><\/br> $58,752.00","Lexington Ave - 59th St ( MAN ) <\/br><\/br> $144,167.00","Jackson Ave ( BRX ) <\/br><\/br> $27,560.00","219th St ( BRX ) <\/br><\/br> $40,917.00","Eastchester - Dyre Ave ( BRX ) <\/br><\/br> $69,308.00","Mets - Willets Point ( QNS ) <\/br><\/br> $50,408.00","Hunters Point Ave ( QNS ) <\/br><\/br> $104,167.00","Queensboro Plz ( QNS ) <\/br><\/br> $54,636.00","69th St ( QNS ) <\/br><\/br> $53,666.00","74th St - Broadway ( QNS ) <\/br><\/br> $52,232.00","40th St ( QNS ) <\/br><\/br> $56,700.00","Kew Gardens - Union Tpke ( QNS ) <\/br><\/br> $70,528.00","Kings Hwy ( BRK ) <\/br><\/br> $50,139.00","Bay Pky ( BRK ) <\/br><\/br> $50,341.00","Coney Island - Stillwell Av ( BRK ) <\/br><\/br> $44,395.00","Clinton - Washington Aves ( BRK ) <\/br><\/br> $81,290.00","Metropolitan Ave ( BRK ) <\/br><\/br> $72,271.00","21st St ( QNS ) <\/br><\/br> $106,641.00","Flushing Ave ( BRK ) <\/br><\/br> $32,073.00","Sutter Ave ( BRK ) <\/br><\/br> $23,836.00","Atlantic Ave ( BRK ) <\/br><\/br> $31,710.00","Myrtle - Wyckoff Aves ( BRK ) <\/br><\/br> $46,250.00","Jefferson St ( BRK ) <\/br><\/br> $50,500.00","36th Ave ( QNS ) <\/br><\/br> $57,462.00","Queensboro Plz ( QNS ) <\/br><\/br> $54,636.00","Herald Sq - 34th St ( MAN ) <\/br><\/br> $106,634.00","Astoria - Ditmars Blvd ( QNS ) <\/br><\/br> $62,721.00","30th Ave ( QNS ) <\/br><\/br> $66,449.00","Canal St ( MAN ) <\/br><\/br> $81,823.00","Whitehall St ( MAN ) <\/br><\/br> $145,658.00"],"type":"scatter","key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83",null,"85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117"],"set":"SharedData0932f068","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","_isNestedKey":false,"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData0932f068"]},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>
</div>
</div>
</div>
<pre class="r"><code>xfun::embed_file(&#39;~/data/subway_income/nyc_train_stops_income_order_borough2.csv&#39;, text = &#39;Download Subway Data&#39;)</code></pre>
<a href="data:text/csv;base64,c3RhdGlvbl9pZCxOQU1FLHRyYWluLGxvbmdpdHVkZSxsYXRpdHVkZSxzdGF0aW9uX29yZGVyLGJvcm91Z2gsbWVkaWFuX2luY29tZQoyOSxCcm9va2x5biBCcmlkZ2UgLSBDaXR5IEhhbGwsNCwtNzQuMDA0MTMxMDAwNTg4NSw0MC43MTMwNjQ5OTk0MzMxLDIxLE1BTiw4MTgyMwozMSxHcmFuZCBDZW50cmFsIC0gNDJuZCBTdCw0LC03My45NzY3MTMyOTkyNTg0LDQwLjc1MTgwNzQyOTgxNjMsMzAsTUFOLDExNTM5MQozMyw5NnRoIFN0LDQsLTczLjk1MTA3MDAwMTU0MjUsNDAuNzg1NjcxOTk5OTg2MSwzNixNQU4sMTA1NDA4CjQyLEZyYW5rbGluIEF2ZSw0LC03My45NTgwOTk3MzY3NzY5LDQwLjY3MDc2NTE1MzQ0ODksMTEsQlJLLDU4NzUyCjQ3LDE0OXRoIFN0IC0gR3JhbmQgQ29uY291cnNlLDQsLTczLjkyNzM4NDc1NDI2MTgsNDAuODE4MzAzNDQzNzIzMiw0MixCUlgsMjgwOTAKNDksTGV4aW5ndG9uIEF2ZSAtIDU5dGggU3QsNCwtNzMuOTY3OTY3MDAwNDczMiw0MC43NjI1MjYwMDAzMDQ2LDMyLE1BTiwxNDQxNjcKMTE1LEdyYW5kIEFybXkgUGxhemEsNCwtNzMuOTcwOTU2MzMxOTIyOCw0MC42NzUyOTQ2OTUxMDMyLDEzLEJSSyw5Njk5MgoxNzUsQnVybnNpZGUgQXZlLDQsLTczLjkwNzY4NDAwMTU5OTcsNDAuODUzNDUzMDAxNTU2OSw0OCxCUlgsMjYxOTYKMjYyLE10IEVkZW4gQXZlLDQsLTczLjkxNDY4NDk5ODYwMzQsNDAuODQ0NDM0MDAwOTI2OCw0NixCUlgsMjUyMjIKNDQ1LE5vc3RyYW5kIEF2ZSw0LC03My45NTA0MjYyNDg5NTc5LDQwLjY2OTkzODE1MDkzMDUsMTAsQlJLLDUxMjUwCjQ2MiwxMTZ0aCBTdCw0LC03My45NDE2MTY5OTgzNzE0LDQwLjc5ODYyOTAwMDIwMDEsMzksTUFOLDMzMTEyCjI5LEJyb29rbHluIEJyaWRnZSAtIENpdHkgSGFsbCw2LC03NC4wMDQxMzEwMDA1ODg1LDQwLjcxMzA2NDk5OTQzMzEsMSxNQU4sODE4MjMKMzAsWmVyZWdhIEF2ZSw2LC03My44NDcwMzU5OTg3NTQ0LDQwLjgzNjQ4ODAwMDYwODIsMzQsQlJYLDQ1MjI3CjMxLEdyYW5kIENlbnRyYWwgLSA0Mm5kIFN0LDYsLTczLjk3NjcxMzI5OTI1ODQsNDAuNzUxODA3NDI5ODE2MywxMCxNQU4sMTE1MzkxCjMzLDk2dGggU3QsNiwtNzMuOTUxMDcwMDAxNTQyNSw0MC43ODU2NzE5OTk5ODYxLDE1LE1BTiwxMDU0MDgKNDksTGV4aW5ndG9uIEF2ZSAtIDU5dGggU3QsNiwtNzMuOTY3OTY3MDAwNDczMiw0MC43NjI1MjYwMDAzMDQ2LDEyLE1BTiwxNDQxNjcKNTIsV2hpdGxvY2sgQXZlLDYsLTczLjg4NjI4Mjk5ODUzMjUsNDAuODI2NTI1MDAwNTU5LDI4LEJSWCwyNzkxMAo0NjIsMTE2dGggU3QsNiwtNzMuOTQxNjE2OTk4MzcxNCw0MC43OTg2MjkwMDAyMDAxLDE5LE1BTiwzMzExMgo5MCxDYW5hbCBTdCwxLC03NC4wMDYyNzcwMDAxNzQ4LDQwLjcyMjg1Mzk5Nzc4NzgsNixNQU4sMTA5ODY3Cjk2LDIzcmQgU3QsMSwtNzMuOTk1NjU3MDAxNjQ4Nyw0MC43NDQwODA5OTk4OTc1LDExLE1BTiwxMjE3MzgKMTY2LENhdGhlZHJhbCBQa3d5ICgxMTB0aCBTdCksMSwtNzMuOTY2ODQ3MDAwNTQ1Niw0MC44MDM5NjY5OTk2MTQ5LDIzLE1BTiw3ODg2OQoxNzgsMTgxc3QgU3QsMSwtNzMuOTMzNTk1OTk5NjA1Niw0MC44NDk1MDQ5OTk3NDA3LDMwLE1BTiw0MzEwMQo0MSxOZXJlaWQgQXZlICgyMzggU3QpLDIsLTczLjg1NDMxNTMxMDc2MjIsNDAuODk4Mjg2NTE1NTc1Myw2MCxCUlgsNTMyMTUKNDIsRnJhbmtsaW4gQXZlLDIsLTczLjk1ODA5OTczNjc3NjksNDAuNjcwNzY1MTUzNDQ4OSw4LEJSSyw1ODc1Mgo5MCxDYW5hbCBTdCwyLC03NC4wMDYyNzcwMDAxNzQ4LDQwLjcyMjg1Mzk5Nzc4NzgsMjIsTUFOLDEwOTg2Nwo5NiwyM3JkIFN0LDIsLTczLjk5NTY1NzAwMTY0ODcsNDAuNzQ0MDgwOTk5ODk3NSwyNyxNQU4sMTIxNzM4CjExNSxHcmFuZCBBcm15IFBsYXphLDIsLTczLjk3MDk1NjMzMTkyMjgsNDAuNjc1Mjk0Njk1MTAzMiwxMCxCUkssOTY5OTIKMjUzLEphY2tzb24gQXZlLDIsLTczLjkwNzcwMTkzODcwODMsNDAuODE2NDM3NDY2ODY0LDQ0LEJSWCwyNzU2MAoyNzMsMjE5dGggU3QsMiwtNzMuODYyNTA5NzA3ODg2Niw0MC44ODM4ODc5NzQ2MjUzLDU3LEJSWCw0MDkxNwoyODAsV2FrZWZpZWxkIC0gMjQxc3QgU3QsMiwtNzMuODUwNjE5OTk4Nzk1NCw0MC45MDMxMjUwMDA1NDEyLDYxLEJSWCw1NTE3OAo0MixGcmFua2xpbiBBdmUsMywtNzMuOTU4MDk5NzM2Nzc2OSw0MC42NzA3NjUxNTM0NDg5LDExLEJSSyw1ODc1MgoxMTUsR3JhbmQgQXJteSBQbGF6YSwzLC03My45NzA5NTYzMzE5MjI4LDQwLjY3NTI5NDY5NTEwMzIsMTMsQlJLLDk2OTkyCjQ0NSxOb3N0cmFuZCBBdmUsMywtNzMuOTUwNDI2MjQ4OTU3OSw0MC42Njk5MzgxNTA5MzA1LDEwLEJSSyw1MTI1MAo1Niw3Mm5kIFN0LEEsLTczLjk3NjMzNjU3NTIxOCw0MC43NzU1MTkzOTcyOTI2LDQ5LE1BTiwxMjU0ODgKMTA0LFJvY2thd2F5IEJsdmQsQSwtNzMuODQzODUyOTk3OTU3Myw0MC42ODA0Mjg5OTk1ODg0LDE1LFFOUyw1OTU0NQoxODIsQmVhY2ggNjB0aCBTdCxBLC03My43ODg1MjE5OTgwMTE4LDQwLjU5MjM3NDAwMTIxMjQsNSxRTlMsNTIzNzUKMjA1LEJlYWNoIDY3dGggU3QsQSwtNzMuNzk2OTIzOTk5ODQyMSw0MC41OTA5MjcwMDA3ODEzLDYsUU5TLDUxMDM2CjIxNCxWYW4gU2ljbGVuIEF2ZSxBLC03My44OTAzNTgwMDAyNDcxLDQwLjY3MjcwOTk5OTA2MSwyNCxCUkssMzY3OTQKNDEwLENhbmFsIFN0IC0gSG9sbGFuZCBUdW5uZWwsQSwtNzQuMDA1MjI5MDAyMzQyNCw0MC43MjA4MjQwMDAwNzEyLDQwLE1BTiwxMDQ4MjEKNTYsNzJuZCBTdCxCLC03My45NzYzMzY1NzUyMTgsNDAuNzc1NTE5Mzk3MjkyNiwxOCxNQU4sMTI1NDg4CjU5LEtpbmdzYnJpZGdlIFJkLEIsLTczLjg5MzUwOTAwMDAzMzEsNDAuODY2OTc3OTk5OTk5NCwzNixCUlgsMzE4MjEKNTYsNzJuZCBTdCxDLC03My45NzYzMzY1NzUyMTgsNDAuNzc1NTE5Mzk3MjkyNiwyOCxNQU4sMTI1NDg4CjIxNCxWYW4gU2ljbGVuIEF2ZSxDLC03My44OTAzNTgwMDAyNDcxLDQwLjY3MjcwOTk5OTA2MSwzLEJSSywzNjc5NAo0MTAsQ2FuYWwgU3QgLSBIb2xsYW5kIFR1bm5lbCxDLC03NC4wMDUyMjkwMDIzNDI0LDQwLjcyMDgyNDAwMDA3MTIsMTksTUFOLDEwNDgyMQo5LDY1dGggU3QsRSwtNzMuODk4Nzg4Mzc4MzMwMSw0MC43NDk3MTk1MjkzNTY4LDE5LFFOUyw1MTM5MwozNyxFbG1odXJzdCBBdmUsRSwtNzMuODgyMDM0NzQ2NTg2NCw0MC43NDIzNzAwNzk3MjE3LDIxLFFOUyw0NzQ0MQo2NCxLZXcgR2FyZGVucyAtIFVuaW9uIFRwa2UsRSwtNzMuODMwMzcwMjcwOTg3OCw0MC43MTQwMzQ4MTk1NzEsMjgsUU5TLDcwNTI4CjE0Miw1dGggQXZlIC0gNTNyZCBTdCxFLC03My45NzUyNDg1MDUyNzM0LDQwLjc2MDA4NjgzMjMxMzMsMTEsTUFOLDEzNzgyNAoyOTksU3RlaW53YXkgU3QsRSwtNzMuOTIwNTI2NDcxNjgyNyw0MC43NTY5ODczNTkxMjU4LDE2LFFOUyw2MzExMwo0MTAsQ2FuYWwgU3QgLSBIb2xsYW5kIFR1bm5lbCxFLC03NC4wMDUyMjkwMDIzNDI0LDQwLjcyMDgyNDAwMDA3MTIsMixNQU4sMTA0ODIxCjksNjV0aCBTdCxNLC03My44OTg3ODgzNzgzMzAxLDQwLjc0OTcxOTUyOTM1NjgsMjksUU5TLDUxMzkzCjM3LEVsbWh1cnN0IEF2ZSxNLC03My44ODIwMzQ3NDY1ODY0LDQwLjc0MjM3MDA3OTcyMTcsMzEsUU5TLDQ3NDQxCjE0Miw1dGggQXZlIC0gNTNyZCBTdCxNLC03My45NzUyNDg1MDUyNzM0LDQwLjc2MDA4NjgzMjMxMzMsMjEsTUFOLDEzNzgyNAoyOTksU3RlaW53YXkgU3QsTSwtNzMuOTIwNTI2NDcxNjgyNyw0MC43NTY5ODczNTkxMjU4LDI2LFFOUyw2MzExMwozNzMsTXlydGxlIEF2ZSxNLC03My45MzU2MjMwMDEyOTk2LDQwLjY5NzE5NTAwMDUxNDUsOCxCUkssNDc4NzMKNDIzLEZyZXNoIFBvbmQgUmQsTSwtNzMuODk1ODk4MDAxNzE5Niw0MC43MDYyMjU5OTgyMzA1LDIsUU5TLDYwMzQ1CjksNjV0aCBTdCxSLC03My44OTg3ODgzNzgzMzAxLDQwLjc0OTcxOTUyOTM1NjgsMzksUU5TLDUxMzkzCjM3LEVsbWh1cnN0IEF2ZSxSLC03My44ODIwMzQ3NDY1ODY0LDQwLjc0MjM3MDA3OTcyMTcsNDEsUU5TLDQ3NDQxCjE0NSxIZXJhbGQgU3EgLSAzNHRoIFN0LFIsLTczLjk4NzkzNjgzMzgyNjQsNDAuNzQ5NjQ0NTYwMDk0NCwyNyxNQU4sMTA2NjM0CjI5OSxTdGVpbndheSBTdCxSLC03My45MjA1MjY0NzE2ODI3LDQwLjc1Njk4NzM1OTEyNTgsMzYsUU5TLDYzMTEzCjMwOSw3N3RoIFN0LFIsLTc0LjAyNTUwOTk5OTYyNjYsNDAuNjI5NzQxNjY2ODg2OSwzLEJSSyw2MDU0NQozMTgsODZ0aCBTdCxSLC03NC4wMjgzOTc5OTk5ODY0LDQwLjYyMjY4NjY2NzE1MDMsMixCUkssNjQ3NzAKNDE3LENhbmFsIFN0LFIsLTc0LjAwMTgyNjAwMDA1NzcsNDAuNzE5NDY1MDAxMDU5LDIxLE1BTiw4MTgyMwo0MjEsV2hpdGVoYWxsIFN0LFIsLTc0LjAxMzAwNzIzNzQyNzIsNDAuNzAzMTQyMzczNTk5MSwxNyxNQU4sMTQ1NjU4Cjc1LEhhbHNleSBTdCxKLC03My45MTY2Mzg4ODQyMTk0LDQwLjY4NjQxNTI3MDcwNDQsMTQsQlJLLDQxODg4CjIxNSxDbGV2ZWxhbmQgU3QsSiwtNzMuODg1MTk0MDAyMTY0Myw0MC42Nzk3Nzc5OTg5NjEyLDE5LEJSSyw0MjcyNwozNzMsTXlydGxlIEF2ZSxKLC03My45MzU2MjMwMDEyOTk2LDQwLjY5NzE5NTAwMDUxNDUsMTEsQlJLLDQ3ODczCjM3MyxNeXJ0bGUgQXZlLFosLTczLjkzNTYyMzAwMTI5OTYsNDAuNjk3MTk1MDAwNTE0NSw4LEJSSyw0Nzg3Mwo1OSxLaW5nc2JyaWRnZSBSZCxELC03My44OTM1MDkwMDAwMzMxLDQwLjg2Njk3Nzk5OTk5OTQsMzksQlJYLDMxODIxCjMxMSw1MHRoIFN0LEQsLTczLjk5NDY1ODc4MDU1MTQsNDAuNjM2MjYwODkwOTYxNCwxMSxCUkssMzM4MjgKMzE0LEJheSBQa3ksRCwtNzMuOTkzNjc2MjAwMDUyOSw0MC42MDE5NTA0NjE1NzIzLDQsQlJLLDQ1NjAyCjM5MixGdCBIYW1pbHRvbiBQa3d5LEQsLTczLjk5NDIwMjIzNzUyODUsNDAuNjQwOTEyNzExNDQ0NywxMixCUkssMzY2NDUKNDY5LENvbmV5IElzbGFuZCAtIFN0aWxsd2VsbCBBdixELC03My45ODEyMzU5OTgxMzk2LDQwLjU3NzI4MTAwMDA2NzUsMSxCUkssNDQzOTUKNzgsMzZ0aCBBdmUsTiwtNzMuOTI5ODYxOTk5MTE4LDQwLjc1NjQ0MjAwMDUxMDQsNDEsUU5TLDU3NDYyCjEwMyxRdWVlbnNib3JvIFBseixOLC03My45NDAxNjM1MzUxOTA5LDQwLjc1MDYzNTY1MTAxNDgsMzksUU5TLDU0NjM2CjE0NSxIZXJhbGQgU3EgLSAzNHRoIFN0LE4sLTczLjk4NzkzNjgzMzgyNjQsNDAuNzQ5NjQ0NTYwMDk0NCwzMyxNQU4sMTA2NjM0CjI1MixBc3RvcmlhIC0gRGl0bWFycyBCbHZkLE4sLTczLjkxMjAzNDAwMDEwMzEsNDAuNzc1MDM1NjY2NTIzNyw0NSxRTlMsNjI3MjEKMzA0LDMwdGggQXZlLE4sLTczLjkyMTQ3OTAwMDE3MzksNDAuNzY2Nzc4NjY2NzMzLDQzLFFOUyw2NjQ0OQo0NjksQ29uZXkgSXNsYW5kIC0gU3RpbGx3ZWxsIEF2LE4sLTczLjk4MTIzNTk5ODEzOTYsNDAuNTc3MjgxMDAwMDY3NSwxLEJSSyw0NDM5NQoxNDUsSGVyYWxkIFNxIC0gMzR0aCBTdCxRLC03My45ODc5MzY4MzM4MjY0LDQwLjc0OTY0NDU2MDA5NDQsMjcsTUFOLDEwNjYzNAozNDAsQXZlIE0sUSwtNzMuOTU5MjQzMTA1MjIxNSw0MC42MTczOTc3NDQ0NDM3LDksQlJLLDU0NDU3CjQ2OSxDb25leSBJc2xhbmQgLSBTdGlsbHdlbGwgQXYsUSwtNzMuOTgxMjM1OTk4MTM5Niw0MC41NzcyODEwMDAwNjc1LDEsQlJLLDQ0Mzk1CjQ3Myw5NnRoIFN0LFEsLTczLjk0NzA2NjAyMTkxODMsNDAuNzg0MjM2NjUwMTc3NywzNCxNQU4sMTAzOTQyCjEwNCxSb2NrYXdheSBCbHZkLFMsLTczLjg0Mzg1Mjk5Nzk1NzMsNDAuNjgwNDI4OTk5NTg4NCxOQSxOQSw1OTU0NQoyOSxCcm9va2x5biBCcmlkZ2UgLSBDaXR5IEhhbGwsNSwtNzQuMDA0MTMxMDAwNTg4NSw0MC43MTMwNjQ5OTk0MzMxLDE1LE1BTiw4MTgyMwozMSxHcmFuZCBDZW50cmFsIC0gNDJuZCBTdCw1LC03My45NzY3MTMyOTkyNTg0LDQwLjc1MTgwNzQyOTgxNjMsMTcsTUFOLDExNTM5MQo0MSxOZXJlaWQgQXZlICgyMzggU3QpLDUsLTczLjg1NDMxNTMxMDc2MjIsNDAuODk4Mjg2NTE1NTc1Myw0MCxCUlgsNTMyMTUKNDIsRnJhbmtsaW4gQXZlLDUsLTczLjk1ODA5OTczNjc3NjksNDAuNjcwNzY1MTUzNDQ4OSw4LEJSSyw1ODc1Mgo0OSxMZXhpbmd0b24gQXZlIC0gNTl0aCBTdCw1LC03My45Njc5NjcwMDA0NzMyLDQwLjc2MjUyNjAwMDMwNDYsMTgsTUFOLDE0NDE2NwoyNTMsSmFja3NvbiBBdmUsNSwtNzMuOTA3NzAxOTM4NzA4Myw0MC44MTY0Mzc0NjY4NjQsMjQsQlJYLDI3NTYwCjI3MywyMTl0aCBTdCw1LC03My44NjI1MDk3MDc4ODY2LDQwLjg4Mzg4Nzk3NDYyNTMsMzcsQlJYLDQwOTE3CjI3OCxFYXN0Y2hlc3RlciAtIER5cmUgQXZlLDUsLTczLjgzMDgzNDAwMjE3NDIsNDAuODg4Mjk5OTk5MDEwMSw0NSxCUlgsNjkzMDgKMjMsTWV0cyAtIFdpbGxldHMgUG9pbnQsNywtNzMuODQ1NjI0OTk4NDE3OSw0MC43NTQ2MjE5OTg4MTI2LDIxLFFOUyw1MDQwOAo5NSxIdW50ZXJzIFBvaW50IEF2ZSw3LC03My45NDg5MTYwMDA5MzkxMDcsNDAuNzQyMjE1OTk5ODYzMiw2LFFOUywxMDQxNjcKMTAzLFF1ZWVuc2Jvcm8gUGx6LDcsLTczLjk0MDE2MzUzNTE5MDksNDAuNzUwNjM1NjUxMDE0OCw4LFFOUyw1NDYzNgoyMzAsNjl0aCBTdCw3LC03My44OTY0MDI5OTkzMTg1LDQwLjc0NjMyNDk5OTQxMDMsMTQsUU5TLDUzNjY2CjIzMSw3NHRoIFN0IC0gQnJvYWR3YXksNywtNzMuODkxMjA1MTI4OTkxMSw0MC43NDY4Njc1NzM4MjkxLDE1LFFOUyw1MjIzMgoyOTQsNDB0aCBTdCw3LC03My45MjQwMTU5OTg0ODgyLDQwLjc0Mzc4MTAwMTQ5MTMsMTAsUU5TLDU2NzAwCjY0LEtldyBHYXJkZW5zIC0gVW5pb24gVHBrZSxGLC03My44MzAzNzAyNzA5ODc4LDQwLjcxNDAzNDgxOTU3MSw0MCxRTlMsNzA1MjgKMzI2LEtpbmdzIEh3eSxGLC03My45NzIzNTUzMDg1MjQ0LDQwLjYwMzI1ODQwNTEyODMsNixCUkssNTAxMzkKMzM5LEJheSBQa3ksRiwtNzMuOTc1MjU2OTc4MjIxNSw0MC42MjA3MzE2MjMxNjc5LDksQlJLLDUwMzQxCjQ2OSxDb25leSBJc2xhbmQgLSBTdGlsbHdlbGwgQXYsRiwtNzMuOTgxMjM1OTk4MTM5Niw0MC41NzcyODEwMDAwNjc1LDEsQlJLLDQ0Mzk1CjExOSxDbGludG9uIC0gV2FzaGluZ3RvbiBBdmVzLEcsLTczLjk2Njc5NTk5ODY2OTUsNDAuNjg4MDk0MDAxMDYwNiwxMSxCUkssODEyOTAKMTQ4LE1ldHJvcG9saXRhbiBBdmUsRywtNzMuOTUxNDIzOTk5NDUyNSw0MC43MTI3NzQwMDA3MzQzLDE3LEJSSyw3MjI3MQoxNTQsMjFzdCBTdCxHLC03My45NDk1OTk5OTk3NTUyLDQwLjc0NDEyODY2NjQ5NTQsMjAsUU5TLDEwNjY0MQozNjQsRmx1c2hpbmcgQXZlLEcsLTczLjk1MDIzNDAwMTAyNTcsNDAuNzAwMzc2NjY2MjIxNSwxNSxCUkssMzIwNzMKNzMsU3V0dGVyIEF2ZSxMLC03My45MDE5MTYwMDA0MjA4LDQwLjY2OTE0NTAwMDYxNCwyMCxCUkssMjM4MzYKMTk0LEF0bGFudGljIEF2ZSxMLC03My45MDMwOTY5OTk1NDAxLDQwLjY3NTM0NDY2NjQwODEsMTksQlJLLDMxNzEwCjIxMixNeXJ0bGUgLSBXeWNrb2ZmIEF2ZXMsTCwtNzMuOTEwOTc1NzE4MjY0Nyw0MC42OTk0NzEwNjI0MjcxLDE0LEJSSyw0NjI1MAozMDUsSmVmZmVyc29uIFN0LEwsLTczLjkyMjkxMzAwMDAzMTIsNDAuNzA2NjA2NjY1OTg4NywxMixCUkssNTA1MDAKNzgsMzZ0aCBBdmUsVywtNzMuOTI5ODYxOTk5MTE4LDQwLjc1NjQ0MjAwMDUxMDQsMTksUU5TLDU3NDYyCjEwMyxRdWVlbnNib3JvIFBseixXLC03My45NDAxNjM1MzUxOTA5LDQwLjc1MDYzNTY1MTAxNDgsMTcsUU5TLDU0NjM2CjE0NSxIZXJhbGQgU3EgLSAzNHRoIFN0LFcsLTczLjk4NzkzNjgzMzgyNjQsNDAuNzQ5NjQ0NTYwMDk0NCwxMSxNQU4sMTA2NjM0CjI1MixBc3RvcmlhIC0gRGl0bWFycyBCbHZkLFcsLTczLjkxMjAzNDAwMDEwMzEsNDAuNzc1MDM1NjY2NTIzNywyMyxRTlMsNjI3MjEKMzA0LDMwdGggQXZlLFcsLTczLjkyMTQ3OTAwMDE3MzksNDAuNzY2Nzc4NjY2NzMzLDIxLFFOUyw2NjQ0OQo0MTcsQ2FuYWwgU3QsVywtNzQuMDAxODI2MDAwMDU3Nyw0MC43MTk0NjUwMDEwNTksNSxNQU4sODE4MjMKNDIxLFdoaXRlaGFsbCBTdCxXLC03NC4wMTMwMDcyMzc0MjcyLDQwLjcwMzE0MjM3MzU5OTEsMSxNQU4sMTQ1NjU4Cg==" download="nyc_train_stops_income_order_borough2.csv">Download Subway Data</a>
</div>
<div id="post-script" class="section level2">
<h2>Post Script</h2>
<p>I ran into a couple of issues labeling stations that might be pertinent.</p>
<ul>
<li><p>Chauncey St and Alabama Avenue in Brooklyn on the Z line seem to be the same station. The latter existed in my stations data set, so it got the station id of 11. The former has Alabama Avenue’s spot on the MTA website.</p></li>
<li><p>The first four Manhattan stops coming from the Brooklyn direction are missing since they weren’t in my stations data set. (Those are station ids 23-26.)</p></li>
<li><p>THe Q train has two Atlantic Center stops (ids 18 &amp; 19) in my data.</p></li>
<li><p>I excluded the S (shuttle bus) line</p></li>
</ul>
</div>

  </div>
</section>
<section id="tag-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-right meta">
      
      
      
      TAGS:
      
      
      <a class="meta" href="/tags/data-viz">DATA-VIZ</a>
      
      
      
    </h6>
  </div>
  
</section>








<section id="menu-pane" class="row menu text-center">
  
  
  <span><a class="menu-item" href="/blog/micropayments-journalism/">&lt; prev | </a></span>
  
  
  <span><a class="menu-item" href="/blog">blog</a></span>
  
  
  
  <h4 class="text-center"><a class="menu-item" href="/">home</a></h4>
</section>



<footer class="row text-center footer">
  <hr />
  
  <h6 class="text-center copyright">© 2019</h6>
  
  <h6 class="text-center powered">Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/shenoybr/hugo-goa">Goa</a>.</h6>
  
  
</footer>

</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  

<script type="text/javascript">
hljs.initHighlightingOnLoad();
</script>




<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'XYZ', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="js/main.js"></script>
</body>
</html>


